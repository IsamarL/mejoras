{% extends 'base.html' %}

{% block titulo %}Login{% endblock %}

{% block contenido %}

<!-- Mensajes flash -->
{% with msg = get_flashed_messages(with_categories=True) %}
  {% if msg %}
    {% for category, message in msg %}
      <div class="alert alert-{{ category }} alert-dismissible fade show text-center" role="alert">
        <strong>{{ message }}</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="container-fluid vh-100 d-flex justify-content-center align-items-center" 
     style="background: linear-gradient(135deg, #74ebd5, #ACB6E5);">
     
  <div class="card shadow-lg p-0" style="border-radius: 1rem; max-width: 900px; width: 100%;">
    <div class="row g-0">

      <!-- Panel izquierdo decorativo -->
      <div class="col-md-5 d-none d-md-flex flex-column justify-content-center align-items-center text-white" 
           style="background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 1rem 0 0 1rem;">
        <i class="bi bi-person-circle display-1 mb-3" 
           style="text-shadow: 0 5px 20px rgba(0,0,0,0.3);"></i>
        <h2 class="fw-bold text-center">¡Bienvenido!</h2>
        <p class="text-center text-light">Si aún no tienes cuenta, regístrate</p>
        <a href="{{ url_for('Registro') }}" class="btn btn-light btn-lg text-purple fw-bold">
          <i class="bi bi-person-plus-fill me-2"></i>Registrarse
        </a>
      </div>

      <!-- Panel derecho (login) -->
      <div class="col-md-7 p-5">
        <h2 class="fw-bold mb-4 text-center text-purple">
          <i class="bi bi-box-arrow-in-right me-2"></i>Iniciar Sesión
        </h2>

        {% if error %}
          <div class="alert alert-danger text-center">{{ error }}</div>
        {% endif %}

        <!-- Botón Google -->
        <div class="d-grid mb-3">
          <button class="btn btn-outline-dark btn-google d-flex align-items-center justify-content-center">
            <i class="bi bi-google fs-4 me-2"></i> Iniciar sesión con Google
          </button>
        </div>

        <p class="text-center fw-bold text-muted my-3">o usar tu correo electrónico</p>

        <!-- Formulario -->
        <form id="loginForm" action="{{ url_for('accesologin') }}" method="POST">
          <div class="form-floating mb-3 position-relative">
            <input type="email" name="email" class="form-control" id="floatingEmail" placeholder="Correo">
            <label for="floatingEmail"><i class="bi bi-envelope-fill me-2"></i>Correo electrónico</label>
          </div>
          <div class="form-floating mb-4 position-relative">
            <input type="password" name="password" class="form-control" id="floatingPassword" placeholder="Contraseña">
            <label for="floatingPassword"><i class="bi bi-lock-fill me-2"></i>Contraseña</label>
          </div>
          <div class="d-grid">
            <button type="submit" class="btn btn-purple btn-lg fw-bold">
              <i class="bi bi-box-arrow-in-right me-2"></i>Entrar
            </button>
          </div>
        </form>
      </div>

    </div>
  </div>
</div>

<!-- Estilos personalizados -->
<style>
.text-purple { color: #6a1b9a; }
.btn-purple { 
  background: linear-gradient(135deg, #8e2de2, #4a00e0); 
  color: #fff; 
  transition: all 0.3s ease; 
}
.btn-purple:hover { 
  transform: scale(1.05); 
  box-shadow: 0 5px 15px rgba(0,0,0,0.3); 
}

.btn-google { transition: all 0.3s ease; }
.btn-google:hover { transform: scale(1.05); }

.form-control:focus + label i,
.form-control:not(:placeholder-shown) + label i {
  animation: bounce 0.6s;
  color: #6a1b9a;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}
</style>

<!-- SweetAlert2 validación campos -->
<script>
document.getElementById('loginForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const email = document.getElementById('floatingEmail').value.trim();
    const password = document.getElementById('floatingPassword').value.trim();

    if (!email || !password) {
        Swal.fire({
            title: 'Validando campos...',
            html: 'Por favor, completa todos los campos',
            allowOutsideClick: false,
            didOpen: () => {
                Swal.showLoading();
            },
            timer: 1500,
            timerProgressBar: true,
        }).then(() => {
            Swal.fire({
                icon: 'warning',
                title: 'Campos vacíos',
                text: 'Todos los campos son obligatorios',
                confirmButtonColor: '#6a1b9a'
            });
        });
        return;
    }

    this.submit();
});
</script>

{% endblock %}